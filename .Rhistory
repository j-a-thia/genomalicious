annotDT[
SIM1 == SIM2 &
grepl('_cous_',SAMPLE1)==TRUE &
grepl('_cous_',SAMPLE2)==TRUE,
FAMILY:='Cousins'
]
# The simulated half-cousins pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_halfcous_',SAMPLE1)==TRUE &
grepl('_halfcous_',SAMPLE2)==TRUE,
FAMILY:='Half-cousins'
]
# All other pairs within simulations are unrelated
annotDT[SIM1 == SIM2 & is.na(FAMILY), FAMILY:='Unrelated']
# Add in a simulation column
annotDT <- annotDT[, SIM:=paste0(SIM1, '|', SIM2)] %>%
.[, !c('SIM1','SIM2')]
# Output
if(type=='matrix'){
return(annotDT[, c('SIM','SAMPLE1','SAMPLE2','FAMILY','Y')])
} else if(type=='id_vec'){
return(annotDT)
}
}
simFamily
library(AGHmatrix)
simGenosMat <- DT2Mat_genos(simFamily)
simGenosMat
simGRM <- Gmatrix(simGenosMat, method='Yang', ploidy=2)
family_sim_annotate(simFam = simGRM, type = 'matrix')
family_sim_annotate(simFam = rownames(simGRM), type = 'id_vec')
simFam = rownames(simGRM)
type = 'id_vec'
if(type=='matrix'){
if(!'matrix' %in% class(simFam)){
stop('Argument `simFam` must be of class "matrix" if argument `type` == "matrix". See ?family_sim_annotate.')
}
}
if(type=='id_vec'){
if(!'character' %in% class(simFam)){
stop('Argument `simFam` must be of class "character" if argument `type` == "id_vec". See ?family_sim_annotate.')
}
}
require(data.table); require(tidyverse)
# Sort the individual sample IDs based on input type
if(type=='matrix'){
annotDT <- simFam %>%
as.matrix() %>%
pairwiseMat2DT(., X1='SAMPLE1', X2='SAMPLE2', Y='Y') %>%
.[SAMPLE1!=SAMPLE2]
} else if(type=='id_vec'){
annotDT <- combn(sort(unique(simFam)), 2) %>%
as.data.table %>%
setnames(., new=c('SAMPLE1', 'SAMPLE2'))
}
combn(sort(unique(simFam)), 2)
annotDT <- combn(sort(unique(simFam)), 2) %>%
t() %>%
as.data.table %>%
setnames(., new=c('SAMPLE1', 'SAMPLE2'))
annotDT
# Simulation ID
annotDT[, SIM1:=sub('_.*', '', SAMPLE1)]
annotDT[, SIM2:=sub('_.*', '', SAMPLE2)]
# All individuals from different simulations are unrelated
annotDT[SIM1!=SIM2, FAMILY:='Unrelated']
# The simulated unrelated pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_unrel_',SAMPLE1)==TRUE &
grepl('_unrel_',SAMPLE2)==TRUE,
FAMILY:='Unrelated'
]
# The simulated sibling pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_sib_',SAMPLE1)==TRUE &
grepl('_sib_',SAMPLE2)==TRUE,
FAMILY:='Siblings'
]
# The simulated half-sibling pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_halfsib_',SAMPLE1)==TRUE &
grepl('_halfsib_',SAMPLE2)==TRUE,
FAMILY:='Half-siblings'
]
# The simulated cousins pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_cous_',SAMPLE1)==TRUE &
grepl('_cous_',SAMPLE2)==TRUE,
FAMILY:='Cousins'
]
# The simulated half-cousins pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_halfcous_',SAMPLE1)==TRUE &
grepl('_halfcous_',SAMPLE2)==TRUE,
FAMILY:='Half-cousins'
]
# All other pairs within simulations are unrelated
annotDT[SIM1 == SIM2 & is.na(FAMILY), FAMILY:='Unrelated']
# Add in a simulation column
annotDT <- annotDT[, SIM:=paste0(SIM1, '|', SIM2)] %>%
.[, !c('SIM1','SIM2')]
annotDT
#' Annotate pairwise matrix of simulated family members
#'
#' Takes a pairwise matrix of individuals generated from \code{family_sim_data}
#' and annotates familial relationships across all pairs of individuals. Note,
#' the pairwise matrix could contain any data, but it is assumed the individuals
#' follow the naming conventions from \code{family_sim_data}.
#'
#' @param simFam Matrix or Character: Either a pairwise matrix or a character vector of
#' individual IDs. If a pairwise matrix, the matrix must be symmetrical:
#' diagonal compares indiviudals to themselves, and off-diagonal is comparisons
#' between individuals; must set \code{type=="matrix"}. If a character vector
#' of sample IDs, must set \code{type=="character"}
#'
#' @param type Character: Either "matrix" or "id_vec".
#'
#' @returns Returns a long-format data.table with the columns:
#' \enumerate{
#'    \item \code{$SIM}, the simulation number for pairs of simulated individuals,
#'    or 'NA' for the pairs of observed individuals.
#'    \item \code{$SAMPLE1}, the sample ID for the first individual.
#'    \item \code{$SAMPLE2}, the sample ID for the second individual.
#'    \item \code{$FAMILY}, the familial relationship for simulated individuals.
#'    \item \code{$Y}, the value in the cell contents from the input matrix.
#' }
#'
#' @examples
#' library(genomalicious)
#' data(data_Genos)
#'
#' # Subset Pop1 genotypes
#' genosPop1 <- data_Genos[POP=='Pop1', c('SAMPLE', 'LOCUS', 'GT')]
#'
#' # Get the allele frequencies for Pop1
#' freqsPop1 <- genosPop1[, .(FREQ=sum(GT)/(length(GT)*2)), by=LOCUS]
#'
#' # Simulate 100 families
#' simFamily <- family_sim_data(
#'    freqData=freqsPop1,
#'    locusCol='LOCUS',
#'    freqCol='FREQ',
#'    numSims=100
#' )
#'
#' ### THE SIMULATED GENETIC RELATIONSHIPS MATRIX
#' library(AGHmatrix)
#'
#' # Convert simulated families into a genotype matrix
#' simGenosMat <- DT2Mat_genos(simFamily)
#'
#' # Calculate the GRM
#' simGRM <- Gmatrix(simGenosMat, method='Yang', ploidy=2)
#'
#' ### THE FAMILAL ANNOTATIONS
#' # From a pairwise matrix (the GRM)
#' family_sim_annotate(simFam = simGRM, type = 'matrix')
#'
#' # From a vector of unique individual IDs
#' family_sim_annotate(simFam = rownames(simGRM), type = 'id_vec')
#'
#' @export
family_sim_annotate <- function(simFam, type){
if(type=='matrix'){
if(!'matrix' %in% class(simFam)){
stop('Argument `simFam` must be of class "matrix" if argument `type` == "matrix". See ?family_sim_annotate.')
}
}
if(type=='id_vec'){
if(!'character' %in% class(simFam)){
stop('Argument `simFam` must be of class "character" if argument `type` == "id_vec". See ?family_sim_annotate.')
}
}
require(data.table); require(tidyverse)
# Sort the individual sample IDs based on input type
if(type=='matrix'){
annotDT <- simFam %>%
as.matrix() %>%
pairwiseMat2DT(., X1='SAMPLE1', X2='SAMPLE2', Y='Y') %>%
.[SAMPLE1!=SAMPLE2]
} else if(type=='id_vec'){
annotDT <- combn(sort(unique(simFam)), 2) %>%
t() %>%
as.data.table %>%
setnames(., new=c('SAMPLE1', 'SAMPLE2'))
}
# Simulation ID
annotDT[, SIM1:=sub('_.*', '', SAMPLE1)]
annotDT[, SIM2:=sub('_.*', '', SAMPLE2)]
# All individuals from different simulations are unrelated
annotDT[SIM1!=SIM2, FAMILY:='Unrelated']
# The simulated unrelated pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_unrel_',SAMPLE1)==TRUE &
grepl('_unrel_',SAMPLE2)==TRUE,
FAMILY:='Unrelated'
]
# The simulated sibling pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_sib_',SAMPLE1)==TRUE &
grepl('_sib_',SAMPLE2)==TRUE,
FAMILY:='Siblings'
]
# The simulated half-sibling pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_halfsib_',SAMPLE1)==TRUE &
grepl('_halfsib_',SAMPLE2)==TRUE,
FAMILY:='Half-siblings'
]
# The simulated cousins pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_cous_',SAMPLE1)==TRUE &
grepl('_cous_',SAMPLE2)==TRUE,
FAMILY:='Cousins'
]
# The simulated half-cousins pair within simulations
annotDT[
SIM1 == SIM2 &
grepl('_halfcous_',SAMPLE1)==TRUE &
grepl('_halfcous_',SAMPLE2)==TRUE,
FAMILY:='Half-cousins'
]
# All other pairs within simulations are unrelated
annotDT[SIM1 == SIM2 & is.na(FAMILY), FAMILY:='Unrelated']
# Add in a simulation column
annotDT <- annotDT[, SIM:=paste0(SIM1, '|', SIM2)] %>%
.[, !c('SIM1','SIM2')]
# Output
if(type=='matrix'){
return(annotDT[, c('SIM','SAMPLE1','SAMPLE2','FAMILY','Y')])
} else if(type=='id_vec'){
return(annotDT[, c('SIM','SAMPLE1','SAMPLE2','FAMILY')])
}
}
family_sim_annotate(simFam = rownames(simGRM), type = 'id_vec')
simFam
family_sim_annotate(simFam)
family_sim_annotate(simFam, type='id_vec')
family_sim_annotate(simFam, type='id_vec') %>%
.[FAMILY=='Unrelated', A:=0] %>%
.[FAMILY=='Half-cousins', A:=0.0625] %>%
.[FAMILY=='Cousins', A:=0.125] %>%
.[FAMILY=='Half-siblings', A:=0.25] %>%
.[FAMILY=='Siblings', A:=0.5] %>%
pairwiseMat2DT(., flip=TRUE, X1='SAMPLE1', X2='SAMPLE2', Y='A', diagAdd=TRUE, diagVal=1)
Amat <- family_sim_annotate(simFam, type='id_vec') %>%
.[FAMILY=='Unrelated', A:=0] %>%
.[FAMILY=='Half-cousins', A:=0.0625] %>%
.[FAMILY=='Cousins', A:=0.125] %>%
.[FAMILY=='Half-siblings', A:=0.25] %>%
.[FAMILY=='Siblings', A:=0.5] %>%
pairwiseMat2DT(., flip=TRUE, X1='SAMPLE1', X2='SAMPLE2', Y='A', diagAdd=TRUE, diagVal=1)
Amat[1:10, 1:10]
#' The additive genetic relatedness matrix for simulated individuals
#'
#' Takes individuals generated from \code{family_sim_data} and returns an
#' additive genetic relatedness matrix
#'
#' @param simFam Character: A vector of simulated indivdiual sample IDs
#'
#' @returns Returns a symmetrical matrix of additive genetic relationships
#' between all pairs of individuals.
#'
#' @examples
#' library(genomalicious)
#' data(data_Genos)
#'
#' # Subset Pop1 genotypes
#' genosPop1 <- data_Genos[POP=='Pop1', c('SAMPLE', 'LOCUS', 'GT')]
#'
#' # Get the allele frequencies for Pop1
#' freqsPop1 <- genosPop1[, .(FREQ=sum(GT)/(length(GT)*2)), by=LOCUS]
#'
#' # Simulate 100 families
#' simFamily <- family_sim_data(
#'    freqData=freqsPop1,
#'    locusCol='LOCUS',
#'    freqCol='FREQ',
#'    numSims=100
#' )
#'
#' ### THE SIMULATED ADDITIVE GENETIC RELATEDNESS MATRIX
#' simARM <- family_sim_Amatrix(unique(simFamily$SAMPLE))
#'
#' @export
family_sim_Amatrix <- function(simFam, type){
require(data.table); require(tidyverse)
Amat <- family_sim_annotate(simFam, type='id_vec') %>%
.[FAMILY=='Unrelated', A:=0] %>%
.[FAMILY=='Half-cousins', A:=0.0625] %>%
.[FAMILY=='Cousins', A:=0.125] %>%
.[FAMILY=='Half-siblings', A:=0.25] %>%
.[FAMILY=='Siblings', A:=0.5] %>%
pairwiseMat2DT(., flip=TRUE, X1='SAMPLE1', X2='SAMPLE2', Y='A', diagAdd=TRUE, diagVal=1)
return(Amat)
}
simARM <- family_sim_Amatrix(unique(simFamily$SAMPLE))
simARM
simARM[1:8, 1:8]
# Developer libraries
libs <- c('devtools', 'roxygen2', 'testthat', 'knitr', 'data.table', 'tidyverse')
for(L in libs){require(L, character.only=TRUE)}
# Make all documents
roxygenise(clean=TRUE)
library(genomalicious)
library(genomalicious)
data(data_Genos)
# Subset Pop1 genotypes
genosPop1 <- data_Genos[POP=='Pop1', c('SAMPLE', 'LOCUS', 'GT')]
# Get the allele frequencies for Pop1
freqsPop1 <- genosPop1[, .(FREQ=sum(GT)/(length(GT)*2)), by=LOCUS]
freqData <- freqsPop1
locusCol='LOCUS'
freqCol='FREQ'
numSims=100L
# Reassign column names.
freqData <- freqData %>%
copy %>%
setnames(., old=c(locusCol,freqCol), new=c('LOCUS','FREQ'))
# Check that numSims is >0 and is an integer
numSims <- as.integer(numSims)
if(!numSims>0){
stop('Argument numSims must be an integer >0. See ?sim_family.')
}
# --------------------------------------------+
# Internal functions
# --------------------------------------------+
FUN_draw_genos <- function(D, ploidy){
# Function to create genotypes assuming random binomial draw at
# each locus. Assumes loci are unlinked.
# D = data.table of population allele freqs, with columns $LOCUS and $FREQ.
# ploidy = integer of number of allles per genotype
D[, .(FREQ=rbinom(n=1, size=ploidy, prob=FREQ)/ploidy), by=LOCUS] %>%
data.table(PLOIDY=ploidy, .)
}
FUN_make_diploid_offspring <- function(D1, D2){
# Function to create diploid offspring from the allele frequencies of two
# diploid individuals.
# D1 and D2 = parental allele frequencies as a data.table for the 1st and 2nd
# parent, respectively. Contain $LOCUS and $FREQ. In this case, allele freqs
# represent the relative dosage of a diploid genotype, so 0 = 0/0, 0.5 = 0/1,
# and 1 = 1/1.
left_join(
FUN_draw_genos(D1, ploidy=1) %>%
setnames(., old='FREQ', new='GAMETE1') %>%
.[, c('LOCUS','GAMETE1')],
FUN_draw_genos(D2, ploidy=1) %>%
setnames(., old='FREQ', new='GAMETE2')%>%
.[, c('LOCUS','GAMETE2')],
by='LOCUS'
) %>%
as.data.table %>%
.[, FREQ:=(GAMETE1 + GAMETE2)/2] %>%
.[, c('LOCUS','FREQ')] %>%
data.table(PLOIDY=2, .)
}
sim=1
# Create a parent-offspring pair (mother and child)
po.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
po.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
po.g2.1 <- FUN_make_diploid_offspring(po.g1.1, po.g1.2)
po.g2.2 <- FUN_make_diploid_offspring(po.g1.1, po.g1.2)
# Create sibling pair
sib.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
sib.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
sib.g2.1 <- FUN_make_diploid_offspring(sib.g1.1, sib.g1.2)
sib.g2.2 <- FUN_make_diploid_offspring(sib.g1.1, sib.g1.2)
# Create half sibling pair
hsib.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
hsib.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
hsib.g1.3 <- FUN_draw_genos(freqData, ploidy=2)
hsib.g2.1 <- FUN_make_diploid_offspring(hsib.g1.1, hsib.g1.2)
hsib.g2.2 <- FUN_make_diploid_offspring(hsib.g1.1, hsib.g1.3)
# Create cousin pair
cuz.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g2.1 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g2.2 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g2.3 <- FUN_make_diploid_offspring(cuz.g1.1, cuz.g1.2)
cuz.g2.4 <- FUN_make_diploid_offspring(cuz.g1.1, cuz.g1.2)
cuz.g3.g1 <- FUN_make_diploid_offspring(cuz.g2.3, cuz.g2.1)
cuz.g3.g2 <- FUN_make_diploid_offspring(cuz.g2.4, cuz.g2.2)
# Create half-cousin pair
hcuz.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
hcuz.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
hcuz.g1.3 <- FUN_draw_genos(freqData, ploidy=2)
hcuz.g2.1 <- FUN_draw_genos(freqData, ploidy=2)
hcuz.g2.2 <- FUN_draw_genos(freqData, ploidy=2)
hcuz.g2.3 <- FUN_make_diploid_offspring(hcuz.g1.1, hcuz.g1.2)
hcuz.g2.4 <- FUN_make_diploid_offspring(hcuz.g1.1, hcuz.g1.3)
hcuz.g3.1 <- FUN_make_diploid_offspring(hcuz.g2.3, hcuz.g2.1)
hcuz.g3.2 <- FUN_make_diploid_offspring(hcuz.g2.4, hcuz.g2.2)
# Random completely unrelated individuals
unrel.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
unrel.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
rbind(
unrel.g1.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_1')),
unrel.g1.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_2')),
po.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_1')),
po.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_2')),
sib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_1')),
sib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_2')),
hsib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_1')),
hsib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_2')),
cuz.g3.g1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_1')),
cuz.g3.g2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_2')),
hcuz.g3.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_1')),
hcuz.g3.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_2'))
)
# All individuals: dams, sires, grandams and grandsires.
po.g1.1 %>% data.table()
po.g1.1
po.g1.1 %>% data.table()
# Focal pairs
foc.pairs.tab <- rbind(
unrel.g1.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_1')),
unrel.g1.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_2')),
po.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_1')),
po.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_2')),
sib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_1')),
sib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_2')),
hsib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_1')),
hsib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_2')),
cuz.g3.g1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_1')),
cuz.g3.g2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_2')),
hcuz.g3.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_1')),
hcuz.g3.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_2'))
) %>%
data.table(
., FAMILY:=c(
rep('Unrelated',2), rep('Parent-offspring',2), rep('Sibling',2),
rep('Half-sibling',2), rep('Cousin',2), rep('Half-cousin',2)
)
)
# Focal pairs
foc.pairs.tab <- rbind(
unrel.g1.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_1')),
unrel.g1.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_2')),
po.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_1')),
po.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_2')),
sib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_1')),
sib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_2')),
hsib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_1')),
hsib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_2')),
cuz.g3.g1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_1')),
cuz.g3.g2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_2')),
hcuz.g3.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_1')),
hcuz.g3.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_2'))
) %>%
data.table(
., FAMILY=c(
rep('Unrelated',2), rep('Parent-offspring',2), rep('Sibling',2),
rep('Half-sibling',2), rep('Cousin',2), rep('Half-cousin',2)
)
)
foc.pairs.tab
# Focal pairs of individuals
foc.pairs.tab <- rbind(
unrel.g1.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_1_ind')),
unrel.g1.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_unrel_2_ind')),
po.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_1_ind')),
po.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_2_ind')),
sib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_1_ind')),
sib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_sib_2_ind')),
hsib.g2.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_1_ind')),
hsib.g2.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfsib_2_ind')),
cuz.g3.g1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_1_ind')),
cuz.g3.g2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_cous_2_ind')),
hcuz.g3.1 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_1_ind')),
hcuz.g3.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_halfcous_2_ind'))
) %>%
data.table(
., FAMILY=c(
rep('Unrelated',2), rep('Parent-offspring',2), rep('Sibling',2),
rep('Half-sibling',2), rep('Cousin',2), rep('Half-cousin',2)
)
)
po.g1.2
po.g1.2 %>% data.table(SIM=sim, SAMPLE=paste0('S',sim,'_po_1_sire'))
paste0('S',sim,c('_po_1_ind','_po_1_dam','_po_1_sire'))
po.ancestors <- paste0('S',sim,c('_po_1_ind','_po_1_dam','_po_1_sire')
# Create sibling pair
sib.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
po.ancestors <- paste0('S',sim,c('_po_1_ind','_po_1_dam','_po_1_sire'))
po.ancestors
# Create a parent-offspring pair (mother and child)
po.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
po.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
po.g2.1 <- FUN_make_diploid_offspring(po.g1.1, po.g1.2)
po.ancestors <- paste0('S',sim,c('_po_1_ind','_po_1_dam','_po_1_sire'))
po.ancestors <- paste0('S',sim,c('_po_1','_po_1_dam','_po_1_sire'))
po.ancestors
po.names <- paste0('S',sim,c('_po_1_','_po_1_dam','_po_1_sire'))
po.names
sib.names <- paste0('S',sim,c('sib_1.1_ind','sib_1.2_ind','sib_1_dam','sib_1_sire'))
# Create cousin pair
cuz.g1.1 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g1.2 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g2.1 <- FUN_make_diploid_offspring(cuz.g1.1, cuz.g1.2)
cuz.g2.2 <- FUN_make_diploid_offspring(cuz.g1.1, cuz.g1.2)
cuz.g2.3 <- FUN_draw_genos(freqData, ploidy=2)
cuz.g2.4 <- FUN_draw_genos(freqData, ploidy=2)
